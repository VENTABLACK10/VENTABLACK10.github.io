---
layout: single
title:  "Time Series Analysis (1)"
---

## 1. Understanding Time Series Forecasting
### 1.1 Components of a Time Series
- 시계열: 시간에 따라 정렬된 데이터 요소의 집합
- 시계열 데이터는 동일한 시간 단계(timestep)로 분포
- 시계열 분해(decomposition): 시계열의 구성요소를 시각화, 시계열을 서로 다른 여러 구성요소로 분리하는 통계적 작업.
- 시계열 구성요소: 추세(trend), 계절성(seasonality), 잔차(residual)
  - 추세의 구성요소: 수준(level)                
    -> 시계열의 전반적인 방향성, 느리게 움직이는 변화를 보여준다. 시간이 지나면서 시계열이 점진적으로 증가 or 감소
  - 계절적 구성요소: 계절적 변동, 패턴을 일컫는 것으로, 일정 기간 동안 발생하는 반복적 행태               
    -> 계절적 구성요소를 통해 추세에서 벗어나는 변화 파악 가능
  - 잔차: 추세 및 계절적 구성요소로 설명할 수 없는 행태, (Trend 도식 + Seasonal 도식)을 각 시점의 값인 Observed 도식과 비교       
    -> (Trend 도식 + Seasonal 도식) = Observed 값 => 잔차 0
    -> 잔차(백색소음)는 무작위 오차에 해당하므로 모델을 만들 수 없고 예측할 수 없는 정보다.

### 1.2 Brid’s-eye view of Time Series Forecasting
1. 목적 설정
2. 예측 대상 설정
3. 예측 기간 설정(horizon)
4. 데이터 수집
5. 예측 모델 기반
  - 계절성 관측 시, SARIMA 모델 활용
  - 계절성 + 풍속, 습도 정보 보유 시(외생 변수), SARIMAX 모델 활용
6. 상용 환경(production) 배포
7. 모니터링
8. 새로운 데이터 수집
9. 5~8 반복
  
### 1.3 Time Series Forecasting VS Regression
1. 시계열은 시간에 따라 데이터 요소의 순서가 지정되고 그 순서를 유지해야 한다. 그렇지 않으면, 예측 시점에 없는 미래 정보로 모델을 훈련하게 된다. 이렇게 생성한 모델은 신뢰할 수 없고 성능이 저하된다. (=예측 편향)     
  =>  따라서 시계열 예측을 위한 모델링 시, 시계열의 순서를 변경 및 데이터 shuffle X
2. 시계열은 다른 특징들을 활용하지 않고 시계열만 활용해서 예측할 수 있다. 발생 or 기록한 시점과 그 시점에 관측된 값만 있는 간단한 데이터 집합이 주어지는 경우가 일반적이다.

## 2. Random Walk
### 2.1 Random Walk Process
- Random Walk(확률보행): 무작위로 상승 or 하락이 발생하는 확률이 동일한 프로세스      
- $y_t = C + y_{t-1} + \varepsilon_t$ (y_t: 현재 값, y_t-1: 이전 시간 단계 값, C: 상수, ε_t: 백색소음)          
  * If, $C = 0$ => drift가 있는 확률 보행
- 확률보행 프로세스를 0으로 초기화 + 상수 C를 0으로 설정하면, t시점의 값은 t시점까지의 백색소음의 합과 같다.                
  * $y_t = \sum_{t=1}^{T} \varepsilon_t$

### 2.2 Identifying a Random Walk
- 시계열이 확률보행에 가까운지 확인하기 위해서 확률보행 정의가 필요
- 확률보행은 첫 번째 차분이 정상적이고 상관관계가 없는 시계열로 정의 가능 => 즉, 절차가 무작위로 변화한다는 의미     
- Random Walk Process(확률 보행 프로세스)           
  1. 정상성(stationary) 확인, 만약 비정상적이라면 차분(differencing)과 같은 변환 적용 필요
  2. 자기상관함수(ACF) 도식화
  3. 자기상관관계 X -> 확률보행 프로세스 ( 자기상관관계 O -> 확률보행 프로세스 X)
  
#### 2.2.1 stationary
- 정상적 시계열(stationary time series): 시간이 지나도 통계적 특성이 변하지 않는 시계열
  => 평균, 분산이 상수이고 자기상관관계가 존재하면서 해당 특성들이 시간에 따라 변하지 않음을 의미
- 정상성을 가정한 시계열 예측 모델: MA, AR, ARMA
- 비정상적 시계열을 다루는 예측 모델: ARIMA, SARIMA
- 시계열을 정상적으로 만들기 위해 시계열 변환(transform) 방법 필요
  * 변환(transform): 수학적 조작을 통해 평균과 분산을 안정화하여 정상적 상태로 만드는 것. ex) 차분
  * 차분: 하나의 시간 단계와 다른 시간 단계 간의 변화를 계산하는 변환법
  * 차분을 통해 평균을 안정화하고 추세 및 계절적 효과를 제거 or 줄일 수 있다.
    => $y'_t = y_t - y_{t-1}$ (t=-1은 존재하지 않으므로 데이터 요소가 하나 손실)
  * 시계열은 여러번 차분 가능, 수행횟수에 따라 1차 차분, 2차 차분이라고 한다.
  * 차분을 사용하면 시간에 관계없이 일정한 평균을 구할 수 있고 시계열에 로그 함수를 적용하면 분산을 안정시킬 수 있다.
  * 변환된 시계열을 모델링 시에는 원래 scale로 되돌리기 위한 역변환을 해야 한다.
- 정상성 테스트(ADF)를 통해 추가 변환 여부를 결정한다.
  * ADF 테스트는 시계열에 단위근(unit root)이 존재한다는 귀무가설을 거정한다.
  * ADF 테스트의 statistic은 음수, 음수의 절댓값이 클수록 귀무가설 기각 가능성 증가(P-value 감소)
  * 수식 표현: $y_t = C + \alpha_1 y_{t-1} + \varepsilon_t$ (과거값에만 의존하는 간단한 시계열 예제)
  * $\alpha_1$은 시계열 근을 의미하고 해당 시계열은 근이 단위 원 내에 있을 경우에만 정상적이다. ($-1 < \alpha < 1$)
- 그래프를 통한 정상성 확인하기

* 정상적 프로세스 평균은 시간이 흐름에도 평평하지만, 비정상적 프로세스의 평균은 변화한다.
* 정상적 수열은 시간에 무관하게 일정한 분산을 보이며, 시간에 독립적이다.
* 비정상적 프로세스는 시간에 따라 변화하는 분산을 보인다.
#### 2.2.2 stationary








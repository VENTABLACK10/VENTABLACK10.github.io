---
layout: single
title:  "데이터 탐색과 시각화"
---

## 1. 탐색적 데이터 분석
탐색적 데이터 분석(EDA)란 가공하지 않은 원천의 데이터를 그대로 탐색하고 분석하는 기법으로 기술통계와 데이터 시각화를 통해 데이터의 특성을 파악한다. EDA(Exploratory Data Analysis) 진행 시, 극단적인 해석은 피해야 하며 지나친 추론이나 자의적 해석도 지양해야 한다. 

### 1.1 EDA 주요 목적
* 데이터의 형태와 척도가 분석에 알맞게 되어있는지 확인(sanity checking)
* 데이터의 평균, 분산, 분포, 패턴 등의 확인을 통해 데이터 특성 파악
* 데이터의 결측값이나 이상치 파악 및 보완
* 변수 간의 관계성 파악
* 분석 목적과 방향성 점검 및 보정

### 1.2 엑셀을 활용한 EDA
* 적은 데이터를 다룰 때, EDA를 하는 가장 간단하면서 효과적인 방법으로 단순 임의 추출을 통해 샘플 데이터와 변수, 설명 리스트를 함께 살펴본다.
* pivot table 생성이 가능하며 필요 시, 그래프를 그려 직관적인 데이터 파악이 가능하다.

### 1.3 탐색적 데이터 분석 실습
```python
# 데이터 샘플 확인
df.head
# 각 칼럼의 속성 및 결측치 확인
df.info()
```
![photo 1](/assets/img/blog/img1.png)    
     
info() 함수는 데이터에 대한 전반적인 정보를 나타낸다. 데이터를 구성하는 행과 열의 크기와 각 칼럼을 구성하는 값의 자료형 등을 확인할 수 있다. 해당 과정에서 결측값을 반드시 확인해야 한다. 결측값이 많은 경우, 결측값을 특정 명으로 대치하고 결측값이 적은 경우 표본 제거 방법을 사용할 수 있다.

```python
# 통계치
df.describe()
```
describe() 함수는 평균, 표준편차, 최대 최소값 등을 한 번에 확인 가능하다.

```python
# 왜도
df.skew()
# 첨도
df.kurtosis()
```
왜도: 데이터 분포의 좌우 비대칭도를 표현하는 척도   
오른꼬리 분포: 평균 < 중앙값    
왼꼬리 분포: 중앙값 < 평균   
첨도: 분포가 정규분포보다 얼마나 뽀족하거나 완만한지의 정도를 나타내는 척도   
첨도의 경우, 분포가 넓지 않은 경우 값이 높게 나올 수 있다.

```python
# 특정 변수 분포 시각화
sns.distplot(df['lead_time'])
# 그룹 구분에 따른 특정 변수 분포 차이 시각화
sns.violinplot(x="hotel", y="lead_time", data=df, inner=None, color=".8")
sns.stripplot(x="hotel", y="lead_time", data=df, size=1)
```
* distplot() 함수: 확인하고자 하는 칼럼의 분포 시각화   
* violinplot() 함수: 분포를 효과적 표현   
* stripplot() 함수: 각 관측치의 위치를 직관적으로 표현
     
![photo 2](/assets/img/blog/img2.png)
![photo 3](/assets/img/blog/img3.png)

## 2. 공분산과 상관성 분석
타깃 변수 Y와 입력 변수 X와의 관계, 입력 변수 X들 간의 관계를 파악하는 것은 중요하다. 해당 관계를 통해 독립 변수의 변화에 따른 종속 변수의 변화량을 크게하여 통계적 정확도를 감소시키는 다중공선성을 방지할 수 있고 데이터에 대한 이해도를 높일 수 있다. 변수 간의 상관관계를 파악하기 위해 공분산과 상관계수를 활용한다.

### 2.1 공분산
* 공분산(Covariance)은 서로 공유하는 분산으로 두 분산의 관계를 의미한다.     
* 공분산 공식: $$ COV(X_{1}, X_{2}) = \frac{1}{n(-1)} \sum{(X_{1i}-\bar{x}_{1})(X_{2i}-\bar{x}_{2})} $$   
* 공분산 값의 의미
  * 양의 상관관계: $$X_{1}$$이 커지면 $$X_{2}$$도 커진다.
  * 음의 상관관계: $$X_{1}$$이 커지면 $$X_{2}$$도 작아진다.
  * 무 상관관계: $$X_{1}$$과 $$X_{2}$$는 선형적 관계가 없다.
  * (-): $$X_{1}$$과 $$X_{2}$$는 완벽한 직선 관계다.
* 공분산의 한계: 긱 변수 간의 다른 척도기준이 그대로 반영되어 공분산 값이 지니는 크기가 상관성의 정도를 나타내지 못한다.

### 2.2 상관계수
* 피어슨 상관계수(R): 공분산을 변수 각각의 표준편차 값으로 나누는 정규화를 하여 상관성을 비교한다.
* 피어슨 상관계수 공식: $P(X_1, X_2) = \frac{Cov(X_1, X_2)}{\sqrt{Var(X_1)Var(X_2)}}, \quad (-1 \leq R \leq 1)$
* 상관계수에 따른 해석
  * 0: Zero
  * 0.1 ~ 0.3 : Weak
  * 0.4 ~ 0.6 : Moderate
  * 0.7 ~ 0.9 : Strong
  * 1: Perfect
* 데이터 분포에 따른 상관계수 예시
![photo 4](/assets/img/blog/img4.png)    
산점도의 기울기와 상관계수는 관련이 없다. 분산의 관계성이 같다면, 기울기가 크든 작든 상관계수는 같다.
* 결정계수: 상관계수(R)를 제곱한 값, 총 변동 중 회귀선에 의해 설명되는 변동이 차지하는 비율로 회귀분석의 정확도를 가늠하는 중요한 기준 값이다.    
* 상관분석은 두 변수의 선형관계만을 측정할 수 있기 때문에 특수 분포의 경우 낮은 상관계수가 나온다. 해당 경우, 산점도 그래프와 함께 확인하는 것이 중요하다.
* 변수 척도에 따른 상관분석 방법      
![photo 5](/assets/img/blog/img5.png)    
  
### 2.3 공분산과 상관성 분석 실습
```python
# 산점도 행렬 시각화
sns.pairplot(df, diag_kind='kde') # diag_kind='kde': 상관계수가 1(동일 변수)이면 분포로 표시
```
pairplot() 함수를 이용해 변수들 간의 상관관계를 산점도 분포로 파악할 수 있다. 

```python
# 공분산 
df.cov()
# 피어슨 상관계수
df.corr(method='pearson') # pearson 생략 가능
```
cov() 함수를 이용해 공분산을 구할 수 있지만 상관성 분석 시 가독성이 떨어져, corr() 함수를 이용해 상관계수를 활용한다. 두 함수 모두 문자형 변수는 제외하고 변수 간 상관관계를 계산한다.

```python
# 히트맵 시각화
sns.heatmap(df.corr(), cmap='viridis')
# clustermap 시각화
sns.clustermap(df.corr(), annot=True, cmap='RdYlBu_r', vmin=-1, vmax=1)
```
![photo 6](/assets/img/blog/img6.png)
heatmap() 함수를 이용해 변수 간의 상관관계를 한눈에 파악할 수 있지만 정확한 수치가 나오지 않는다.      
반면, clustermap() 함수는 히트맵과 상관계수를 함께 확인할 수 있다.























